<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE sqlMap PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN" "http://ibatis.apache.org/dtd/sql-map-2.dtd" >
<sqlMap namespace="t_reserve_plan_infor" >
<typeAlias alias="reservePlanDetailDto" type="com.tl.resource.business.dto.ReservePlanDetailDto"/>

  <resultMap id="ibatorgenerated_BaseResultMap" class="com.tl.resource.dao.pojo.TReservePlanInfor" >
    <!--
      WARNING - This element is automatically generated by Apache iBATIS ibator, do not modify.
      This element was generated on Sun Oct 10 11:49:50 CST 2010.
    -->
    <result column="id" property="id" jdbcType="VARCHAR" />
    <result column="stock_order_detail_id" property="stockOrderDetailId" jdbcType="VARCHAR" />
    <result column="brand_code" property="brandCode" jdbcType="VARCHAR" />
    <result column="product_code" property="productCode" jdbcType="VARCHAR" />
    <result column="tools_id" property="toolsId" jdbcType="VARCHAR" />
    <result column="parent_tools_id" property="parentToolsId" jdbcType="VARCHAR" />
    <result column="leaf" property="leaf" jdbcType="INTEGER" />
    <result column="product_name" property="productName" jdbcType="VARCHAR" />
    <result column="plan_amount" property="planAmount" jdbcType="DECIMAL" />
    <result column="product_unit" property="productUnit" jdbcType="VARCHAR" />
    <result column="price" property="price" jdbcType="DECIMAL" />
    <result column="product_money" property="productMoney" jdbcType="DECIMAL" />
    <result column="order_infor_id" property="orderInforId" jdbcType="VARCHAR" />
    <result column="order_code" property="orderCode" jdbcType="VARCHAR" />
    <result column="contract_id" property="contractId" jdbcType="VARCHAR" />
    <result column="contract_code" property="contractCode" jdbcType="VARCHAR" />
    <result column="status" property="status" jdbcType="INTEGER" />
    <result column="plan_code" property="planCode" jdbcType="VARCHAR" />
    <result column="edit_date" property="editDate" jdbcType="TIMESTAMP" />
    <result column="user_id" property="userId" jdbcType="VARCHAR" />
    <result column="user_name" property="userName" jdbcType="VARCHAR" />
    <result column="product_brand" property="productBrand" jdbcType="VARCHAR" />
    <result column="mat_stock_order_detail_id" property="matStockOrderDetailId" jdbcType="VARCHAR" />
    <result column="memo" property="memo" jdbcType="VARCHAR" />
    <result column="memo2" property="memo2" jdbcType="VARCHAR" />
    <result column="main_Id" property="mainId" jdbcType="VARCHAR" />
    <result column="delivery_date" property="deliveryDate" jdbcType="VARCHAR" />
    <result column="out_amount" jdbcType="DECIMAL" property="outAmount" />
    <result column="order_amount" jdbcType="DECIMAL" property="orderAmount" />
    <result column="arrival_amount" jdbcType="DECIMAL" property="arrivalAmount" />
  </resultMap>
  <resultMap id="resultHasReserve" class="reservePlanDetailDto" extends="ibatorgenerated_BaseResultMap">
    <result property="reserveAmount" column="reserve_amount" jdbcType="DECIMAL"/>
    <result property="reserveInforId" column="reserve_Infor_Id" jdbcType="VARCHAR"/>
  </resultMap>
  
   <resultMap id="resultMap" class="reservePlanDetailDto" extends="ibatorgenerated_BaseResultMap">
  </resultMap>
  
  <sql id="ibatorgenerated_Example_Where_Clause" >
    <!--
      WARNING - This element is automatically generated by Apache iBATIS ibator, do not modify.
      This element was generated on Sun Oct 10 11:49:50 CST 2010.
    -->
    <iterate property="oredCriteria" conjunction="or" prepend="where" removeFirstPrepend="iterate" >
      <isEqual property="oredCriteria[].valid" compareValue="true" >
        (
        <iterate prepend="and" property="oredCriteria[].criteriaWithoutValue" conjunction="and" >
          $oredCriteria[].criteriaWithoutValue[]$
        </iterate>
        <iterate prepend="and" property="oredCriteria[].criteriaWithSingleValue" conjunction="and" >
          $oredCriteria[].criteriaWithSingleValue[].condition$
            #oredCriteria[].criteriaWithSingleValue[].value#
        </iterate>
        <iterate prepend="and" property="oredCriteria[].criteriaWithListValue" conjunction="and" >
          $oredCriteria[].criteriaWithListValue[].condition$
          <iterate property="oredCriteria[].criteriaWithListValue[].values" open="(" close=")" conjunction="," >
            #oredCriteria[].criteriaWithListValue[].values[]#
          </iterate>
        </iterate>
        <iterate prepend="and" property="oredCriteria[].criteriaWithBetweenValue" conjunction="and" >
          $oredCriteria[].criteriaWithBetweenValue[].condition$
          #oredCriteria[].criteriaWithBetweenValue[].values[0]# and
          #oredCriteria[].criteriaWithBetweenValue[].values[1]#
        </iterate>
        )
      </isEqual>
    </iterate>
  </sql>
  <select id="ibatorgenerated_selectByExample" resultMap="ibatorgenerated_BaseResultMap" parameterClass="com.tl.resource.dao.pojo.TReservePlanInforExample" >
    <!--
      WARNING - This element is automatically generated by Apache iBATIS ibator, do not modify.
      This element was generated on Sun Oct 10 11:49:50 CST 2010.
    -->
    select id, stock_order_detail_id, brand_code, product_code, tools_id, parent_tools_id, leaf,
      product_name, plan_amount, product_unit, price, product_money, order_infor_id, order_code,
      contract_id, contract_code, status, plan_code, edit_date, user_id, user_name, product_brand,
      mat_stock_order_detail_id, memo,memo2,main_id,delivery_date, out_amount, order_amount,arrival_amount
    from t_reserve_plan_infor
    <isParameterPresent >
      <include refid="t_reserve_plan_infor.ibatorgenerated_Example_Where_Clause" />
      <isNotNull property="orderByClause" >
        order by $orderByClause$
      </isNotNull>
      <isNotEmpty property="startIndex" >
        limit $startIndex$,$pageSize$
    </isNotEmpty>
    </isParameterPresent>
  </select>
  <select id="ibatorgenerated_selectByPrimaryKey" resultMap="ibatorgenerated_BaseResultMap" parameterClass="com.tl.resource.dao.pojo.TReservePlanInfor" >
    <!--
      WARNING - This element is automatically generated by Apache iBATIS ibator, do not modify.
      This element was generated on Sun Oct 10 11:49:50 CST 2010.
    -->
    select id, stock_order_detail_id, brand_code, product_code, tools_id, parent_tools_id, leaf,
      product_name, plan_amount, product_unit, price, product_money, order_infor_id, order_code,
      contract_id, contract_code, status, plan_code, edit_date, user_id, user_name, product_brand,
      mat_stock_order_detail_id, memo,memo2,main_id,delivery_date, out_amount, order_amount,arrival_amount
    from t_reserve_plan_infor
    where id = #id:VARCHAR#
  </select>
  <delete id="ibatorgenerated_deleteByPrimaryKey" parameterClass="com.tl.resource.dao.pojo.TReservePlanInfor" >
    <!--
      WARNING - This element is automatically generated by Apache iBATIS ibator, do not modify.
      This element was generated on Sun Oct 10 11:49:50 CST 2010.
    -->
    delete from t_reserve_plan_infor
    where id = #id:VARCHAR#
  </delete>
  <delete id="ibatorgenerated_deleteByExample" parameterClass="com.tl.resource.dao.pojo.TReservePlanInforExample" >
    <!--
      WARNING - This element is automatically generated by Apache iBATIS ibator, do not modify.
      This element was generated on Sun Oct 10 11:49:50 CST 2010.
    -->
    delete from t_reserve_plan_infor
    <include refid="t_reserve_plan_infor.ibatorgenerated_Example_Where_Clause" />
  </delete>
  <insert id="ibatorgenerated_insert" parameterClass="com.tl.resource.dao.pojo.TReservePlanInfor" >
    <!--
      WARNING - This element is automatically generated by Apache iBATIS ibator, do not modify.
      This element was generated on Sun Oct 10 11:49:50 CST 2010.
    -->
    insert into t_reserve_plan_infor (id, stock_order_detail_id, brand_code, product_code, tools_id,
      parent_tools_id, leaf, product_name, plan_amount, product_unit, price, product_money,
      order_infor_id, order_code, contract_id, contract_code, status, plan_code, edit_date, user_id,
      user_name, product_brand, mat_stock_order_detail_id, memo,memo2,main_id,delivery_date, out_amount, order_amount,arrival_amount)
    values (#id:VARCHAR#, #stockOrderDetailId:VARCHAR#, #brandCode:VARCHAR#, #productCode:VARCHAR#,
      #toolsId:VARCHAR#, #parentToolsId:VARCHAR#, #leaf:INTEGER#, #productName:VARCHAR#,
      #planAmount:DECIMAL#, #productUnit:VARCHAR#, #price:DECIMAL#, #productMoney:DECIMAL#,
      #orderInforId:VARCHAR#, #orderCode:VARCHAR#, #contractId:VARCHAR#, #contractCode:VARCHAR#,
      #status:INTEGER#, #planCode:VARCHAR#, #editDate:TIMESTAMP#, #userId:VARCHAR#,
      #userName:VARCHAR#, #productBrand:VARCHAR#, #matStockOrderDetailId:VARCHAR#, #memo:VARCHAR#,#memo2:VARCHAR#,#mainId:VARCHAR#,#deliveryDate#, #outAmount:DECIMAL#,#orderAmount:DECIMAL#, #arrivalAmount:DECIMAL#)
  </insert>
  <insert id="ibatorgenerated_insertSelective" parameterClass="com.tl.resource.dao.pojo.TReservePlanInfor" >
    <!--
      WARNING - This element is automatically generated by Apache iBATIS ibator, do not modify.
      This element was generated on Sun Oct 10 11:49:50 CST 2010.
    -->
    insert into t_reserve_plan_infor
    <dynamic prepend="(" >
      <isNotNull prepend="," property="id" >
        id
      </isNotNull>
      <isNotNull prepend="," property="stockOrderDetailId" >
        stock_order_detail_id
      </isNotNull>
      <isNotNull prepend="," property="brandCode" >
        brand_code
      </isNotNull>
      <isNotNull prepend="," property="productCode" >
        product_code
      </isNotNull>
      <isNotNull prepend="," property="toolsId" >
        tools_id
      </isNotNull>
      <isNotNull prepend="," property="parentToolsId" >
        parent_tools_id
      </isNotNull>
      <isNotNull prepend="," property="leaf" >
        leaf
      </isNotNull>
      <isNotNull prepend="," property="productName" >
        product_name
      </isNotNull>
      <isNotNull prepend="," property="planAmount" >
        plan_amount
      </isNotNull>
      <isNotNull prepend="," property="productUnit" >
        product_unit
      </isNotNull>
      <isNotNull prepend="," property="price" >
        price
      </isNotNull>
      <isNotNull prepend="," property="productMoney" >
        product_money
      </isNotNull>
      <isNotNull prepend="," property="orderInforId" >
        order_infor_id
      </isNotNull>
      <isNotNull prepend="," property="orderCode" >
        order_code
      </isNotNull>
      <isNotNull prepend="," property="contractId" >
        contract_id
      </isNotNull>
      <isNotNull prepend="," property="contractCode" >
        contract_code
      </isNotNull>
      <isNotNull prepend="," property="status" >
        status
      </isNotNull>
      <isNotNull prepend="," property="planCode" >
        plan_code
      </isNotNull>
      <isNotNull prepend="," property="editDate" >
        edit_date
      </isNotNull>
      <isNotNull prepend="," property="userId" >
        user_id
      </isNotNull>
      <isNotNull prepend="," property="userName" >
        user_name
      </isNotNull>
      <isNotNull prepend="," property="productBrand" >
        product_brand
      </isNotNull>
      <isNotNull prepend="," property="matStockOrderDetailId" >
        mat_stock_order_detail_id
      </isNotNull>
      <isNotNull prepend="," property="memo" >
        memo
      </isNotNull>
       <isNotNull prepend="," property="memo2" >
        memo2
      </isNotNull>
       <isNotNull prepend="," property="mainId" >
        main_id
      </isNotNull>
       <isNotNull prepend="," property="deliveryDate" >
        delivery_date
      </isNotNull>
      <isNotNull prepend="," property="outAmount">
        out_amount 
      </isNotNull>
      <isNotNull prepend="," property="orderAmount">
        order_amount 
      </isNotNull>
      <isNotNull prepend="," property="arrivalAmount">
        arrival_amount 
      </isNotNull>
      )
    </dynamic>
    values
    <dynamic prepend="(" >
      <isNotNull prepend="," property="id" >
        #id:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="stockOrderDetailId" >
        #stockOrderDetailId:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="brandCode" >
        #brandCode:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="productCode" >
        #productCode:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="toolsId" >
        #toolsId:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="parentToolsId" >
        #parentToolsId:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="leaf" >
        #leaf:INTEGER#
      </isNotNull>
      <isNotNull prepend="," property="productName" >
        #productName:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="planAmount" >
        #planAmount:DECIMAL#
      </isNotNull>
      <isNotNull prepend="," property="productUnit" >
        #productUnit:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="price" >
        #price:DECIMAL#
      </isNotNull>
      <isNotNull prepend="," property="productMoney" >
        #productMoney:DECIMAL#
      </isNotNull>
      <isNotNull prepend="," property="orderInforId" >
        #orderInforId:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="orderCode" >
        #orderCode:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="contractId" >
        #contractId:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="contractCode" >
        #contractCode:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="status" >
        #status:INTEGER#
      </isNotNull>
      <isNotNull prepend="," property="planCode" >
        #planCode:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="editDate" >
        #editDate:TIMESTAMP#
      </isNotNull>
      <isNotNull prepend="," property="userId" >
        #userId:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="userName" >
        #userName:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="productBrand" >
        #productBrand:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="matStockOrderDetailId" >
        #matStockOrderDetailId:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="memo" >
        #memo:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="memo2" >
        #memo2:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="mainId" >
        #main_id:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="deliveryDate" >
        #delivery_date:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="outAmount">
        #outAmount:DECIMAL#
      </isNotNull>
      <isNotNull prepend="," property="orderAmount">
        #orderAmount:DECIMAL#
      </isNotNull>
      <isNotNull prepend="," property="arrivalAmount">
        #arrivalAmount:DECIMAL#
      </isNotNull>
      )
    </dynamic>
  </insert>
  <select id="ibatorgenerated_countByExample" parameterClass="com.tl.resource.dao.pojo.TReservePlanInforExample" resultClass="java.lang.Integer" >
    <!--
      WARNING - This element is automatically generated by Apache iBATIS ibator, do not modify.
      This element was generated on Sun Oct 10 11:49:50 CST 2010.
    -->
    select count(*) from t_reserve_plan_infor
    <include refid="t_reserve_plan_infor.ibatorgenerated_Example_Where_Clause" />
  </select>
  <update id="ibatorgenerated_updateByExampleSelective" >
    <!--
      WARNING - This element is automatically generated by Apache iBATIS ibator, do not modify.
      This element was generated on Sun Oct 10 11:49:50 CST 2010.
    -->
    update t_reserve_plan_infor
    <dynamic prepend="set" >
      <isNotNull prepend="," property="record.id" >
        id = #record.id:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="record.stockOrderDetailId" >
        stock_order_detail_id = #record.stockOrderDetailId:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="record.brandCode" >
        brand_code = #record.brandCode:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="record.productCode" >
        product_code = #record.productCode:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="record.toolsId" >
        tools_id = #record.toolsId:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="record.parentToolsId" >
        parent_tools_id = #record.parentToolsId:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="record.leaf" >
        leaf = #record.leaf:INTEGER#
      </isNotNull>
      <isNotNull prepend="," property="record.productName" >
        product_name = #record.productName:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="record.planAmount" >
        plan_amount = #record.planAmount:DECIMAL#
      </isNotNull>
      <isNotNull prepend="," property="record.productUnit" >
        product_unit = #record.productUnit:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="record.price" >
        price = #record.price:DECIMAL#
      </isNotNull>
      <isNotNull prepend="," property="record.productMoney" >
        product_money = #record.productMoney:DECIMAL#
      </isNotNull>
      <isNotNull prepend="," property="record.orderInforId" >
        order_infor_id = #record.orderInforId:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="record.orderCode" >
        order_code = #record.orderCode:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="record.contractId" >
        contract_id = #record.contractId:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="record.contractCode" >
        contract_code = #record.contractCode:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="record.status" >
        status = #record.status:INTEGER#
      </isNotNull>
      <isNotNull prepend="," property="record.planCode" >
        plan_code = #record.planCode:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="record.editDate" >
        edit_date = #record.editDate:TIMESTAMP#
      </isNotNull>
      <isNotNull prepend="," property="record.userId" >
        user_id = #record.userId:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="record.userName" >
        user_name = #record.userName:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="record.productBrand" >
        product_brand = #record.productBrand:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="record.matStockOrderDetailId" >
        mat_stock_order_detail_id = #record.matStockOrderDetailId:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="record.memo" >
        memo = #record.memo:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="record.memo2" >
        memo2 = #record.memo2:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="record.mainId" >
        main_id = #record.mainId:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="record.deliveryDate" >
        delivery_date = #record.deliveryDate:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="record.outAmount">
        out_amount = #record.outAmount:DECIMAL#
      </isNotNull>
      <isNotNull prepend="," property="record.orderAmount">
        order_amount = #record.orderAmount:DECIMAL#
      </isNotNull>
      <isNotNull prepend="," property="record.arrivalAmount">
        arrival_amount = #record.arrivalAmount:DECIMAL#
      </isNotNull>
    </dynamic>
    <isParameterPresent >
      <include refid="t_reserve_plan_infor.ibatorgenerated_Example_Where_Clause" />
    </isParameterPresent>
  </update>
  <update id="ibatorgenerated_updateByExample" >
    <!--
      WARNING - This element is automatically generated by Apache iBATIS ibator, do not modify.
      This element was generated on Sun Oct 10 11:49:50 CST 2010.
    -->
    update t_reserve_plan_infor
    set id = #record.id:VARCHAR#,
      stock_order_detail_id = #record.stockOrderDetailId:VARCHAR#,
      brand_code = #record.brandCode:VARCHAR#,
      product_code = #record.productCode:VARCHAR#,
      tools_id = #record.toolsId:VARCHAR#,
      parent_tools_id = #record.parentToolsId:VARCHAR#,
      leaf = #record.leaf:INTEGER#,
      product_name = #record.productName:VARCHAR#,
      plan_amount = #record.planAmount:DECIMAL#,
      product_unit = #record.productUnit:VARCHAR#,
      price = #record.price:DECIMAL#,
      product_money = #record.productMoney:DECIMAL#,
      order_infor_id = #record.orderInforId:VARCHAR#,
      order_code = #record.orderCode:VARCHAR#,
      contract_id = #record.contractId:VARCHAR#,
      contract_code = #record.contractCode:VARCHAR#,
      status = #record.status:INTEGER#,
      plan_code = #record.planCode:VARCHAR#,
      edit_date = #record.editDate:TIMESTAMP#,
      user_id = #record.userId:VARCHAR#,
      user_name = #record.userName:VARCHAR#,
      product_brand = #record.productBrand:VARCHAR#,
      mat_stock_order_detail_id = #record.matStockOrderDetailId:VARCHAR#,
      memo = #record.memo:VARCHAR#,
      memo2 = #record.memo2:VARCHAR#,
      main_id = #record.mainId:VARCHAR#,
      delivery_date= #record.deliveryDate:VARCHAR#,
      out_amount = #record.outAmount:DECIMAL#,
      order_amount = #record.orderAmount:DECIMAL#,
      arrival_amount = #record.arrivalAmount:DECIMAL#
    <isParameterPresent >
      <include refid="t_reserve_plan_infor.ibatorgenerated_Example_Where_Clause" />
    </isParameterPresent>
  </update>
  <update id="ibatorgenerated_updateByPrimaryKeySelective" parameterClass="com.tl.resource.dao.pojo.TReservePlanInfor" >
    <!--
      WARNING - This element is automatically generated by Apache iBATIS ibator, do not modify.
      This element was generated on Sun Oct 10 11:49:50 CST 2010.
    -->
    update t_reserve_plan_infor
    <dynamic prepend="set" >
      <isNotNull prepend="," property="stockOrderDetailId" >
        stock_order_detail_id = #stockOrderDetailId:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="brandCode" >
        brand_code = #brandCode:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="productCode" >
        product_code = #productCode:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="toolsId" >
        tools_id = #toolsId:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="parentToolsId" >
        parent_tools_id = #parentToolsId:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="leaf" >
        leaf = #leaf:INTEGER#
      </isNotNull>
      <isNotNull prepend="," property="productName" >
        product_name = #productName:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="planAmount" >
        plan_amount = #planAmount:DECIMAL#
      </isNotNull>
      <isNotNull prepend="," property="productUnit" >
        product_unit = #productUnit:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="price" >
        price = #price:DECIMAL#
      </isNotNull>
      <isNotNull prepend="," property="productMoney" >
        product_money = #productMoney:DECIMAL#
      </isNotNull>
      <isNotNull prepend="," property="orderInforId" >
        order_infor_id = #orderInforId:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="orderCode" >
        order_code = #orderCode:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="contractId" >
        contract_id = #contractId:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="contractCode" >
        contract_code = #contractCode:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="status" >
        status = #status:INTEGER#
      </isNotNull>
      <isNotNull prepend="," property="planCode" >
        plan_code = #planCode:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="editDate" >
        edit_date = #editDate:TIMESTAMP#
      </isNotNull>
      <isNotNull prepend="," property="userId" >
        user_id = #userId:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="userName" >
        user_name = #userName:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="productBrand" >
        product_brand = #productBrand:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="matStockOrderDetailId" >
        mat_stock_order_detail_id = #matStockOrderDetailId:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="memo" >
        memo = #memo:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="memo2" >
        memo2 = #memo2:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="mainId" >
        main_id = #mainId:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="deliveryDate" >
        delivery_date = #deliveryDate:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="outAmount">
        out_amount = #outAmount:DECIMAL#
      </isNotNull>
      <isNotNull prepend="," property="orderAmount">
        order_amount = #orderAmount:DECIMAL#
      </isNotNull>
      <isNotNull prepend="," property="arrivalAmount">
        arrival_amount = #arrivalAmount:DECIMAL#
      </isNotNull>
    </dynamic>
    where id = #id:VARCHAR#
  </update>
  <update id="ibatorgenerated_updateByPrimaryKey" parameterClass="com.tl.resource.dao.pojo.TReservePlanInfor" >
    <!--
      WARNING - This element is automatically generated by Apache iBATIS ibator, do not modify.
      This element was generated on Sun Oct 10 11:49:50 CST 2010.
    -->
    update t_reserve_plan_infor
    set stock_order_detail_id = #stockOrderDetailId:VARCHAR#,
      brand_code = #brandCode:VARCHAR#,
      product_code = #productCode:VARCHAR#,
      tools_id = #toolsId:VARCHAR#,
      parent_tools_id = #parentToolsId:VARCHAR#,
      leaf = #leaf:INTEGER#,
      product_name = #productName:VARCHAR#,
      plan_amount = #planAmount:DECIMAL#,
      product_unit = #productUnit:VARCHAR#,
      price = #price:DECIMAL#,
      product_money = #productMoney:DECIMAL#,
      order_infor_id = #orderInforId:VARCHAR#,
      order_code = #orderCode:VARCHAR#,
      contract_id = #contractId:VARCHAR#,
      contract_code = #contractCode:VARCHAR#,
      status = #status:INTEGER#,
      plan_code = #planCode:VARCHAR#,
      edit_date = #editDate:TIMESTAMP#,
      user_id = #userId:VARCHAR#,
      user_name = #userName:VARCHAR#,
      product_brand = #productBrand:VARCHAR#,
      mat_stock_order_detail_id = #matStockOrderDetailId:VARCHAR#,
      memo = #memo:VARCHAR#,
      memo2 = #memo2:VARCHAR#,
      main_id = #mainId:VARCHAR#,
      delivery_date = #deliveryDate#,
      out_amount = #outAmount:DECIMAL#,
      order_amount = #orderAmount:DECIMAL#,
      arrival_amount = #arrivalAmount:DECIMAL#
    where id = #id:VARCHAR#
  </update>
  
  <select id="getReservePlanDetail" parameterClass="java.util.List" resultClass="java.util.List" resultMap="resultHasReserve">
	SELECT
	  pl.*,
	  IFNULL(ri.amount,0) reserve_amount,
	  ri.id reserve_Infor_Id 
	FROM  t_reserve_plan_infor pl LEFT JOIN t_reserve_infor ri
	ON pl.product_code = ri.product_code
	WHERE  IFNULL(pl.plan_amount,0) - IFNULL(pl.out_amount,0) - IFNULL(pl.order_amount,0)
	and pl.main_id in 
    <iterate conjunction="," open="(" close=")">  
            #value[]#  
   </iterate>  
	AND IFNULL(ri.amount,0) > 0
	ORDER BY pl.id
  </select>
  
  <!-- 根据供应商ID得到储备计划列表 -->
  <select id="getPlanList" parameterClass="java.util.Map" resultClass="java.util.List" resultMap="resultMap">
		SELECT ss.history_price * (1-((IFNULL(re.rebate,0)/100))) price,ss.* FROM 
		(
		   SELECT  IFNULL(his.history_price,0) history_price,i.* FROM (
			      SELECT 
				  r.id, r.stock_order_detail_id, r.brand_code, r.product_code, r.tools_id,
			      r.parent_tools_id, r.leaf, r.product_name, r.plan_amount, r.product_unit, product_money,
			      r.order_infor_id, r.order_code, r.contract_id, r.contract_code, r.status, r.plan_code, r.edit_date, r.user_id,
			      r.user_name,r.product_brand,r.mat_stock_order_detail_id,r.memo,r.memo2,r.main_id,r.delivery_Date,r.out_amount, r.order_amount,r.arrival_amount,pd.order_price_run_date,nc.product_sort_id product_sort_id
				FROM 
				t_reserve_plan_infor r,
				t_suppliers_brand b,
				t_product_tools_infor nc,
				t_product_brand pd
				WHERE b.t_suppliers_id =  '$supplierId$'
				AND r.product_brand = b.brand
				AND r.status = 2 
				AND r.leaf = 1   
				AND r.product_brand = b.brand
				AND r.tools_id = nc.id
				AND nc.product_brand = pd.name 
		    <isNotEmpty property="brandCode" prepend="and">
		    	r.brand_code LIKE '%$brandCode$%'
		    </isNotEmpty>
		    <isNotEmpty property="productName" prepend="and">
		    	r.product_name LIKE '%$productName$%'
		    </isNotEmpty>
		    <isNotEmpty property="sort" >
		          ORDER BY $sort$ $dir$
		    </isNotEmpty>
		    <isEmpty property="sort" >
		          ORDER BY r.edit_date DESC
		    </isEmpty>
		    <isNotEmpty property="startIndex">
		       LIMIT #startIndex#, #pageSize# 
		    </isNotEmpty>
			) i LEFT JOIN 
			t_sales_price_history his
			ON  SUBSTR(i.product_code,INSTR(i.product_code,'-')+1)= his.product_tool_infor_id
			AND i.order_price_run_date = his.sale_price_date
		) ss LEFT JOIN t_rebate re 
		ON re.product_sort_id = ss.product_sort_id
		AND re.customers_degree_id = 'xxx'
  </select>
  
  <select id="getPlanListCount" parameterClass="java.util.Map" resultClass="java.lang.Integer">
  	select count(*)
  	from 
	t_reserve_plan_infor r,
	t_suppliers_brand b
	where 
	b.t_suppliers_id = '$supplierId$'
	and
	r.product_brand = b.brand
	and
	r.status = 2
	<isNotEmpty property="brandCode" prepend="and">
    	r.brand_code like '$brandCode$'
    </isNotEmpty>
    <isNotEmpty property="productName" prepend="and">
    	r.product_name like '$productName$'
    </isNotEmpty>
  </select>
  
  
  <update id="updateReservePlanByOrderId" parameterClass="java.lang.String" >
    <!--
      WARNING - This element is automatically generated by Apache iBATIS ibator, do not modify.
      This element was generated on Mon Nov 23 20:26:45 CST 2009.
    -->
    update t_reserve_plan_infor set status = 2,order_amount = 0 
	where id in 
	(select d.contract_product_detail_id from t_order_detail d where stock_order_infor_id = #id:VARCHAR#)
  </update>
  <update id="updateReservePlanArrivalAmountById" parameterClass="java.lang.String" >
    UPDATE t_reserve_plan_infor re SET re.arrival_amount = (
     SELECT SUM(pa.arrival_amount) FROM t_order_detail td,t_product_arrival_detail pa WHERE td.id = pa.order_detail_id AND td.contract_product_detail_id = #planId#
    ) WHERE re.id = #planId#
  </update>
</sqlMap>